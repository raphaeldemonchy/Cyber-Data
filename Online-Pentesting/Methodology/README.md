# [ Méthodologie Online Pentest]

### DÉFINITION :

- **Whois** -> Service qui permet la recherche d'informations sur l'enregistrement d'un nom de domaine ou d'une adresse IP. Fournit des détails comme : *Nom du propriétaire du domaine*, *coordonées du contact du propiétaire*, *date de création et d'expiration du domaine*

- **SSL (Secure Sockets Layer)** -> Protocole de sécurité qui permet de chiffrer les communications entre un navigateur web et un serveur. Lorsqu'un serveur utilise SSL, il possède un certificat SSL. Ce certificat contient des informations comme : *le nom de domaine du serveur*, *organisation qui possède le certificat*

- **Reverse DNS Lookup** -> Méthode permettant de retouver le nom de domaine associé a une adresse IP. Utile pour identifier des services hébergés sur une adresse IP spécifique. Contrairement au DNS classique (qui traduit les noms de domaine en adresse IP), le reverse DNS permet de faire l'inverse : *partire d'une adresse IP pour retrouver le nom de domaine associé*

-----------------------------
- **Acquisitions** -> Dans le contexte du pentesting, les acquisitions désignent les entreprise que l'entreprise principale a achetées ou intégrées dans son groupe. Ces acquisitions peuvent avoir des actifs informatiques (site web, réseau, adresse IP) qui font partie du périmètre du pentest

- **Shodan** -> Moteur de recherche spécialisé, qui permet de trouver des appareils connectés a Internet, comme des serveurs, des caméras, des rooteurs et bien plus. Il recherche et indexe les services et dispositifs accessibles publiquement sur internet. Pour un pentest, SHodan permet d'identifier aussi des actifs appartenant a une entreprise en recherchant par *nom*, *adresse IP*, ou *certificat SSL*

---

- **ASN (Autonomous System Number)** -> Numéro unique, attribué a chaque "systéme autonome", qui représente un réseau. Un systéme autonome est un groupe de réseau IP qui a une politique de routage unique. (En trouvant l'ASN d'une entreprise on peut identifier les plages d'adresse IP qui lui appartiennent)


- **FQDN (Fully Qualified Domain Name)** -> Nom de domaine complet, qui inclut le nom de l'hote et tous les niveaux de domaine. ***Exemple*** : ```www.sms.eskooly.com*``` est **FQND** qui pointe vers une ressource spécifique sur le réseau.

- **A Record** -> L'enregistrement **A** (Adresse Record) mappe un nom de domaine (FQDN) a une adresse IPv4. ***Exemple*** : ```jadeed.eskooly.com*" --> a_record --> 217.21.93.111``` Donc le domaine "*jadeed.eskooly.com*" est résolu a l'adresse IP 217.21.93.111.

- **AAAA Record** -> L'enregistrement **AAAA** (Quad-A Record) mappe un FQND a une adresse IPv6. ***Exemple*** : ```holyvirgin.eskooly.com --> aaaa_record --> 2a02:4780:11:768:0:1da7:b1d4:2``` Donc le domaine "*holyvirgin.eskooly.com*" est résolu a l'adresse IPv6 2a02:4780:11:768:0:1da7:b1d4:2.

- **CNAME Record (Canonical Name Record)** -> Est un alias pour un autre domaine. Cela redirige essentiellement un FQND vers un autre. ***Exemple***: ```www.sms.eskooly.com.cdn.hstgr.net --> cname_record --> www.sms.eskooly.com.cdn.hstgr.net```  Signifie que "*www.sms.eskooly.com*" est un alias pour "*www.sms.eskooly.com.cdn.hstgr.net*".

- **MX Record (Mail Exchange Record)** -> Il spécifie les serveurs responsables de la gestion des e-mails pour un domaine. ***Exemple***: ```sms.eskooly.com --> mx_record --> mx1.hostinger.com``` Signifie que les e-mails envoyés a "*sms.eskooly.com*" seront gérés par le serveur de messagerie "*mx1.hostinger.com*". 

- **NS Record (Name Server Record)** -> Il indique quels serveurs de noms (DNS) sont responsables pour un domaine. ***Exemple***: ```sms.eskooly.com --> ns_record --> ns1.dns-parking.com``` Signifie que "*ns1.dns-parking.com*" est le serveur de noms responsable du domaine "*sms.eskooly.com*".

- **Netblock** --> C'est une plage d'adresse IP (souvent représentée en notation CIDR). Il représente un groupe d'adresse IP géré par un fournisseur de services. ***Exemple***: ```2a02:4780:11::/48``` Est un **netblock** IPv6 contenant plusieurs adresse IP. Les adresses qui y figurent partagent une partie commune de leur adresse.

- **Announces (Annonce d'ASN)** --> Un **ASN** peut annoncer un **netblock**, ce qui signifie qu'il gère les adresse IP dans ce bloc et les  rend disponibles a travers le réseau. ***Exemple***: ```47583 (ASN) --> announces --> 2a02:4780:11::/48```.

- **RIROrganization (Regional Internet Registry Organization)** --> Est une entité qui gère l'attribution des adresses IP et des ASN dans une région spécifique du monde. ***Exemple***: ```13335 (ASN) --> managed_by --> Cloudflare, Inc``` Indique que l'ASN "*13335*" est géré par l'organisation "*Cloudflare, Inc*".

- **Managed_by** : --> Indique qu'elle organisation ou entreprise gère un ASN spécifique. ***Exemple***: ```22612 (ASN) --> managed_by --> Namecheap, Inc``` Signifie que l'ASN "*22612*" est sous la gestion de l'organisation "*Namecheap*".


# RECON

## Information Gathering

### 1. Enumeration **Domains** & **Subdomains** 

Tools : https://github.com/owasp-amass/amass

- **[Cartographie passive des ***sous-domaines***, de notre domaine cible]**.

- **[Vérification des certificats]** Tester SSL et DNS **SITE : https://crt.sh/ & https://dnsdumpster.com/**

- **[Analyze des enregistrements DNS]** 

- **[Lister des technologies utilisées sur le site]**

- **[Identification des services]**
---
### 2. Analyse de l'infrastructure du site

***IF CMS***

- **[ Identification des cms ]** Il faut identifier si le site utilise un CMS (ex:***WordPress***, ***Joomla***, ***Drupal***) Pour *WordPress* par exemple vérifier les chemins spécifiques tel que ```/wp-admin/```, ```/administrator/```, ou ```/user/``` pour confirmer.
**TOOLS : WPScan**

- **[ Vérification des vulnérabilités connues ]**  Consulter les bases de données de vulnérabilités pour les CMS identifiés. **SITE : Exploit-DB, CVE-Details**

**ELSE**

- **[ Enumeration des fichiers et répertoires sensibles ]** Explorer tout les répertoires connu a l'aide de directory wordlist et identifier les plus sensisbles.
Rechercher les fichiers de sauvegarde, les fichiers de configuration ou autre ressources critiques.

---
### 3. Exploration de l'application WEB

- **[ Analyse des point d'entrée utilisateur ]** Listez les formulaires, champ de texte, zone d'authentification, point de téléchargement, etc. Recherchez les ***paramétres GET/POST***  en interceptant les requetes. Recherchez aussi les potentielle endpoint d'API s'il y en a ```/api/```, ```/graphql``` **TOOLS : BurpSuite**

- **[ Identification des vulnérabilités d'injection ]** Testez les champs et paramètres pour des vulérabilités d'injection.
```Injection SQL```, ```XSS (Cross-Site scripting)```, ```Injection de commande```.

- **[ Récolte et test des cookies et tokens ]**  Analyser les ***cookies*** pour trouver des informations qui pourrais étre sensibles (session ID, jetons d'authentification) **TOOLS : BurpSuite**

---



### 4\. Cartographie des vulnérabilités (Vulnerability Mapping)

- **[ Analyse des permissions et de l'authentification ]** Testez la gestion des sessions pour voir si des attaques de fixation de sessions, d'élévation de privilèges ou de contournement d'authentification sont possibles. Vérifier si la ***gestion de cookies*** est confirme au bonnes pratiques (protection par ```HttpOnly``` et ```Secure```) 

- **[ Recherchez des pages non authentificatiées ]** Essayez d'accéder a des ressources normalement protégées sans étre authentifié. Rechercher des vulérabilitées de type ***IDOR ( Insecure Direct Object Reference )***.
---
### 5\. Vérification de la sécurité réseau

- **[ Tests de pare-feu et WAF]** Testez la présence d'un ***WAF (Web Application Firewall)*** en injectant des requetes malformées et analyser les réponse. **TOOLS : WafWoof**

- **[ Test SSL/TLS]** Utilisez ***SSL Labs*** vérifier la configuration SSL/TLS du site et identifier les failles cpùùe ***POODLE, Hearthbleed*** ou des protocoles obsolètes.
----
### 6\. Reconaissance automatisé

- https://github.com/yogeshojha/rengine

- https://github.com/j3ssie/Osmedeus
----
### 7\. Procédure de Test

- https://book.hacktricks.xyz/generic-methodologies-and-resources/external-recon-methodology#osint